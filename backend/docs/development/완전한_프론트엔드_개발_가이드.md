# ğŸ”¥ SPICE HARVESTER ë°±ì—”ë“œ - ì™„ì „í•œ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ê°€ì´ë“œ

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
2. [ì„œë¹„ìŠ¤ ê°œìš”](#ì„œë¹„ìŠ¤-ê°œìš”)
3. [ë³µí•© ë°ì´í„° íƒ€ì… ì‹œìŠ¤í…œ](#ë³µí•©-ë°ì´í„°-íƒ€ì…-ì‹œìŠ¤í…œ)
4. [ë²„ì „ ì œì–´ ì‹œìŠ¤í…œ](#ë²„ì „-ì œì–´-ì‹œìŠ¤í…œ)
5. [ë³´ì•ˆ ë° ê²€ì¦](#ë³´ì•ˆ-ë°-ê²€ì¦)
6. [ë ˆì´ë¸” ë§¤í•‘ ì‹œìŠ¤í…œ](#ë ˆì´ë¸”-ë§¤í•‘-ì‹œìŠ¤í…œ)
7. [ë³‘í•© ì¶©ëŒ í•´ê²°](#ë³‘í•©-ì¶©ëŒ-í•´ê²°)
8. [ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬](#ë°ì´í„°ë² ì´ìŠ¤-ê´€ë¦¬)
9. [ì¿¼ë¦¬ ì‹œìŠ¤í…œ](#ì¿¼ë¦¬-ì‹œìŠ¤í…œ)
10. [ì¸ì¦ ë° ê¶Œí•œ ë¶€ì—¬](#ì¸ì¦-ë°-ê¶Œí•œ-ë¶€ì—¬)
11. [ì—ëŸ¬ ì²˜ë¦¬](#ì—ëŸ¬-ì²˜ë¦¬)
12. [ì›¹ì†Œì¼“ ë° ì‹¤ì‹œê°„ ê¸°ëŠ¥](#ì›¹ì†Œì¼“-ë°-ì‹¤ì‹œê°„-ê¸°ëŠ¥)
13. [í…ŒìŠ¤íŠ¸ ë° ê°œë°œ](#í…ŒìŠ¤íŠ¸-ë°-ê°œë°œ)
14. [í”„ë¡œë•ì…˜ ë°°í¬](#í”„ë¡œë•ì…˜-ë°°í¬)

---

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜
SPICE HARVESTER ë°±ì—”ë“œëŠ” **ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜**ë¥¼ ë”°ë¥´ë©° ë‘ ê°œì˜ ì£¼ìš” ì„œë¹„ìŠ¤ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:

1. **Backend-for-Frontend (BFF)** - í¬íŠ¸ 8002
   - ì‚¬ìš©ì ëŒ€ë©´ API ê³„ì¸µ
   - ë°ì´í„° ì§‘ê³„ ë° ë³€í™˜
   - ë ˆì´ë¸” ë§¤í•‘ ë° ë‹¤êµ­ì–´ ì§€ì›
   - ë³‘í•© ì¶©ëŒ í•´ê²°

2. **ì˜¨í†¨ë¡œì§€ ê´€ë¦¬ ì„œë¹„ìŠ¤ (OMS)** - í¬íŠ¸ 8000
   - í•µì‹¬ ì˜¨í†¨ë¡œì§€ ì‘ì—…
   - TerminusDB í†µí•©
   - ë²„ì „ ì œì–´ (Gitê³¼ ìœ ì‚¬)
   - ê³ ê¸‰ ê´€ê³„ ê´€ë¦¬

### ê¸°ìˆ  ìŠ¤íƒ
- **FastAPI** - REST API í”„ë ˆì„ì›Œí¬
- **TerminusDB** - ì˜¨í†¨ë¡œì§€ìš© ê·¸ë˜í”„ ë°ì´í„°ë² ì´ìŠ¤
- **httpx** - ë¹„ë™ê¸° HTTP í´ë¼ì´ì–¸íŠ¸
- **SQLite** - ë ˆì´ë¸” ë§¤í•‘ ì˜ì†ì„±
- **Pydantic** - ë°ì´í„° ê²€ì¦
- **WebSocket** - ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸

---

## ğŸŒ ì„œë¹„ìŠ¤ ê°œìš”

### 1. Backend-for-Frontend (BFF) ì„œë¹„ìŠ¤
**ê¸°ë³¸ URL**: `http://localhost:8002`

#### ì‚¬ìš© ê°€ëŠ¥í•œ ì—”ë“œí¬ì¸íŠ¸:
- **ì˜¨í†¨ë¡œì§€ ê´€ë¦¬**: `/api/v1/ontology/{db_name}/`
- **ì¿¼ë¦¬ ì‹œìŠ¤í…œ**: `/api/v1/query/{db_name}/`
- **ë ˆì´ë¸” ë§¤í•‘**: `/api/v1/database/{db_name}/mappings/`
- **ë³‘í•© ì¶©ëŒ**: `/api/v1/database/{db_name}/merge/`

### 2. ì˜¨í†¨ë¡œì§€ ê´€ë¦¬ ì„œë¹„ìŠ¤ (OMS)
**ê¸°ë³¸ URL**: `http://localhost:8000`

#### ì‚¬ìš© ê°€ëŠ¥í•œ ì—”ë“œí¬ì¸íŠ¸:
- **ë°ì´í„°ë² ì´ìŠ¤**: `/api/v1/database/`
- **ì˜¨í†¨ë¡œì§€**: `/api/v1/ontology/{db_name}/`
- **ë²„ì „ ì œì–´**: `/api/v1/version/{db_name}/`
- **ë¸Œëœì¹˜ ê´€ë¦¬**: `/api/v1/branch/{db_name}/`

---

## ğŸ”¥ ë³µí•© ë°ì´í„° íƒ€ì… ì‹œìŠ¤í…œ

### ì§€ì›ë˜ëŠ” ë°ì´í„° íƒ€ì…

#### ê¸°ë³¸ íƒ€ì… (XSD):
```typescript
type BasicDataType = 
  | "xsd:string" | "xsd:integer" | "xsd:decimal" | "xsd:boolean"
  | "xsd:date" | "xsd:dateTime" | "xsd:time" | "xsd:duration"
  | "xsd:anyURI" | "xsd:base64Binary" | "xsd:hexBinary"
  | "xsd:normalizedString" | "xsd:token" | "xsd:language"
  | "xsd:double" | "xsd:float" | "xsd:long" | "xsd:int"
  | "xsd:short" | "xsd:byte" | "xsd:nonNegativeInteger"
  | "xsd:positiveInteger" | "xsd:nonPositiveInteger"
  | "xsd:negativeInteger" | "xsd:unsignedLong"
  | "xsd:unsignedInt" | "xsd:unsignedShort" | "xsd:unsignedByte"
  | "xsd:gYear" | "xsd:gMonth" | "xsd:gDay" | "xsd:gYearMonth"
  | "xsd:gMonthDay" | "xsd:QName" | "xsd:NOTATION";
```

#### ğŸ”¥ ë³µí•© íƒ€ì… (ì‚¬ìš©ì ì •ì˜):
```typescript
type ComplexDataType = 
  | "custom:array"      // ê²€ì¦ì´ í¬í•¨ëœ ë™ì  ë°°ì—´
  | "custom:object"     // ìŠ¤í‚¤ë§ˆ ê²€ì¦ì´ í¬í•¨ëœ ì¤‘ì²© ê°ì²´
  | "custom:enum"       // ë‹¤êµ­ì–´ ë ˆì´ë¸”ì´ í¬í•¨ëœ ì—´ê±°í˜•
  | "custom:money"      // ì •ë°€ë„ì™€ ë¡œì¼€ì¼ì´ í¬í•¨ëœ í†µí™”
  | "custom:phone"      // êµ­ì œ ì „í™”ë²ˆí˜¸ ê²€ì¦
  | "custom:email"      // ë„ë©”ì¸ í™•ì¸ì´ í¬í•¨ëœ ì´ë©”ì¼ ê²€ì¦
  | "custom:coordinate" // ì§€ë¦¬ì  ì¢Œí‘œ (ìœ„ë„/ê²½ë„)
  | "custom:address"    // êµ¬ì¡°í™”ëœ ìš°í¸ ì£¼ì†Œ
  | "custom:image"      // ê²€ì¦ì´ í¬í•¨ëœ ì´ë¯¸ì§€ ë©”íƒ€ë°ì´í„°
  | "custom:file";      // íƒ€ì… í™•ì¸ì´ í¬í•¨ëœ íŒŒì¼ ì²¨ë¶€
```

### ë³µí•© íƒ€ì… ì‚¬ìš© ì˜ˆì‹œ

#### 1. ë°°ì—´ íƒ€ì…
```typescript
// ìš”ì²­ ë³¸ë¬¸
{
  "id": "Product",
  "properties": {
    "tags": {
      "type": "custom:array",
      "constraints": {
        "items": {
          "type": "xsd:string",
          "maxLength": 50
        },
        "minItems": 1,
        "maxItems": 10,
        "uniqueItems": true
      }
    }
  }
}

// ìœ íš¨í•œ ë°ì´í„°
{
  "tags": ["ì „ìì œí’ˆ", "ëª¨ë°”ì¼", "ìŠ¤ë§ˆíŠ¸í°"]
}
```

#### 2. ê°ì²´ íƒ€ì…
```typescript
// ìš”ì²­ ë³¸ë¬¸
{
  "id": "Person",
  "properties": {
    "address": {
      "type": "custom:object",
      "constraints": {
        "properties": {
          "street": {"type": "xsd:string", "maxLength": 100},
          "city": {"type": "xsd:string", "maxLength": 50},
          "zipCode": {"type": "xsd:string", "pattern": "\\d{5}"}
        },
        "required": ["street", "city"]
      }
    }
  }
}

// ìœ íš¨í•œ ë°ì´í„°
{
  "address": {
    "street": "ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123",
    "city": "ì„œìš¸",
    "zipCode": "12345"
  }
}
```

#### 3. í†µí™” íƒ€ì…
```typescript
// ìš”ì²­ ë³¸ë¬¸
{
  "id": "Product",
  "properties": {
    "price": {
      "type": "custom:money",
      "constraints": {
        "currency": "KRW",
        "precision": 2,
        "minimum": 0,
        "maximum": 10000000
      }
    }
  }
}

// ìœ íš¨í•œ ë°ì´í„°
{
  "price": {
    "amount": 29900,
    "currency": "KRW"
  }
}
```

#### 4. ì´ë©”ì¼ íƒ€ì…
```typescript
// ìš”ì²­ ë³¸ë¬¸
{
  "id": "User",
  "properties": {
    "email": {
      "type": "custom:email",
      "constraints": {
        "domains": ["company.com", "gmail.com"],
        "maxLength": 255
      }
    }
  }
}

// ìœ íš¨í•œ ë°ì´í„°
{
  "email": "user@company.com"
}
```

#### 5. ì¢Œí‘œ íƒ€ì…
```typescript
// ìš”ì²­ ë³¸ë¬¸
{
  "id": "Location",
  "properties": {
    "position": {
      "type": "custom:coordinate",
      "constraints": {
        "crs": "EPSG:4326",
        "precision": 6
      }
    }
  }
}

// ìœ íš¨í•œ ë°ì´í„°
{
  "position": {
    "latitude": 37.5665,
    "longitude": 126.9780
  }
}
```

---

## ğŸ”€ ë²„ì „ ì œì–´ ì‹œìŠ¤í…œ

### Gitê³¼ ìœ ì‚¬í•œ ì‘ì—…

#### 1. ë¸Œëœì¹˜ ê´€ë¦¬
```typescript
// ë¸Œëœì¹˜ ëª©ë¡ ì¡°íšŒ
GET /api/v1/branch/{db_name}/list

// ë¸Œëœì¹˜ ìƒì„±
POST /api/v1/branch/{db_name}/create
{
  "branch_name": "feature/new-ontology",
  "from_branch": "main"
}

// ë¸Œëœì¹˜ ì‚­ì œ
DELETE /api/v1/branch/{db_name}/branch/{branch_name}?force=false

// ë¸Œëœì¹˜ ì²´í¬ì•„ì›ƒ
POST /api/v1/branch/{db_name}/checkout
{
  "target": "develop",
  "target_type": "branch"
}
```

#### 2. ì»¤ë°‹ ì‘ì—…
```typescript
// ì»¤ë°‹ ìƒì„±
POST /api/v1/version/{db_name}/commit
{
  "message": "ìƒˆë¡œìš´ ì œí’ˆ ì˜¨í†¨ë¡œì§€ ì¶”ê°€",
  "author": "admin"
}

// ì»¤ë°‹ íˆìŠ¤í† ë¦¬ ì¡°íšŒ
GET /api/v1/version/{db_name}/history?branch=main&limit=10&offset=0

// ì»¤ë°‹ ê°„ ì°¨ì´ ì¡°íšŒ
GET /api/v1/version/{db_name}/diff?from_ref=main&to_ref=feature/new-ontology
```

#### 3. ë³‘í•© ì‘ì—…
```typescript
// ë¸Œëœì¹˜ ë³‘í•©
POST /api/v1/version/{db_name}/merge
{
  "source_branch": "feature/new-ontology",
  "target_branch": "main",
  "strategy": "auto"
}

// ì»¤ë°‹ìœ¼ë¡œ ë¡¤ë°±
POST /api/v1/version/{db_name}/rollback
{
  "target": "HEAD~1"
}

// ë¸Œëœì¹˜ ë¦¬ë² ì´ìŠ¤
POST /api/v1/version/{db_name}/rebase?onto=main&branch=feature/new-ontology
```

---

## ğŸ”’ ë³´ì•ˆ ë° ê²€ì¦

### ì…ë ¥ ì •í™”
ëª¨ë“  ì‚¬ìš©ì ì…ë ¥ì€ í¬ê´„ì ì¸ `InputSanitizer` í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ìë™ìœ¼ë¡œ ì •í™”ë©ë‹ˆë‹¤:

#### íƒì§€ë˜ëŠ” ë³´ì•ˆ íŒ¨í„´:
- **SQL ì¸ì ì…˜**: `SELECT`, `INSERT`, `UPDATE`, `DELETE`, `DROP`, `--`, `/*` ë“±
- **XSS**: `<script>`, `<iframe>`, `javascript:`, `eval()` ë“±
- **ê²½ë¡œ ì¡°ì‘**: `../`, `..\\`, URL ì¸ì½”ë”©ëœ ë³€í˜•
- **ëª…ë ¹ ì¸ì ì…˜**: ì…¸ ë©”íƒ€ë¬¸ì, ëª…ë ¹ íŒ¨í„´
- **NoSQL ì¸ì ì…˜**: `$where`, `$ne`, `$regex` ë“±
- **LDAP ì¸ì ì…˜**: í•„í„° íŒ¨í„´, íŠ¹ìˆ˜ ë¬¸ì

#### ìš”ì²­ ê²€ì¦ ë¯¸ë“¤ì›¨ì–´
```typescript
// ë³´ì•ˆ ì„¤ì •
{
  "MAX_REQUEST_SIZE": 10 * 1024 * 1024, // 10MB
  "MAX_JSON_DEPTH": 10,
  "MAX_FIELD_LENGTH": 1000,
  "MAX_ARRAY_LENGTH": 1000,
  "MAX_REQUESTS_PER_MINUTE": 100,
  "MAX_REQUESTS_PER_HOUR": 1000
}

// ìë™ ë³´ì•ˆ í—¤ë”
{
  "X-Content-Type-Options": "nosniff",
  "X-Frame-Options": "DENY",
  "X-XSS-Protection": "1; mode=block",
  "Referrer-Policy": "strict-origin-when-cross-origin"
}
```

### ì¸ì¦ ë° ê¶Œí•œ ë¶€ì—¬
```typescript
// ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ ê²€ì¦
function validateDbName(name: string): boolean {
  return /^[a-zA-Z][a-zA-Z0-9_-]*$/.test(name);
}

// ë¸Œëœì¹˜ ì´ë¦„ ê²€ì¦
function validateBranchName(name: string): boolean {
  return /^[a-zA-Z0-9_/-]+$/.test(name);
}

// í´ë˜ìŠ¤ ID ê²€ì¦
function validateClassId(id: string): boolean {
  return /^[a-zA-Z][a-zA-Z0-9_:-]*$/.test(id);
}
```

---

## ğŸ·ï¸ ë ˆì´ë¸” ë§¤í•‘ ì‹œìŠ¤í…œ

### ë‹¤êµ­ì–´ ì§€ì›
ì‹œìŠ¤í…œì€ êµ­ì œí™”ë¥¼ ìœ„í•œ í¬ê´„ì ì¸ ë ˆì´ë¸” ë§¤í•‘ì„ ì§€ì›í•©ë‹ˆë‹¤:

#### 1. ë§¤í•‘ ë‚´ë³´ë‚´ê¸°
```typescript
// ëª¨ë“  ë§¤í•‘ ë‚´ë³´ë‚´ê¸°
GET /api/v1/database/{db_name}/mappings/export

// ì‘ë‹µ
{
  "db_name": "product_ontology",
  "classes": [
    {
      "class_id": "Product",
      "label": "ì œí’ˆ",
      "label_lang": "ko",
      "description": "ì œí’ˆ ì •ë³´"
    }
  ],
  "properties": [
    {
      "property_id": "name",
      "label": "ì´ë¦„",
      "label_lang": "ko"
    }
  ],
  "relationships": [
    {
      "predicate": "hasCategory",
      "label": "ì¹´í…Œê³ ë¦¬",
      "label_lang": "ko"
    }
  ]
}
```

#### 2. ë§¤í•‘ ê°€ì ¸ì˜¤ê¸°
```typescript
// íŒŒì¼ ì—…ë¡œë“œë¡œ ê°€ì ¸ì˜¤ê¸°
POST /api/v1/database/{db_name}/mappings/import
Content-Type: multipart/form-data

// ë³´ì•ˆ ê¸°ëŠ¥:
// - íŒŒì¼ í¬ê¸° ì œí•œ: 10MB
// - ì»¨í…ì¸  íƒ€ì… ê²€ì¦
// - ìŠ¤í‚¤ë§ˆ ê²€ì¦
// - ë¬´ê²°ì„± ê²€ì‚¬ (SHA256)
// - ì‹¤íŒ¨ ì‹œ ë¡¤ë°±
```

#### 3. ë§¤í•‘ í†µê³„
```typescript
// ë§¤í•‘ ìš”ì•½ ì¡°íšŒ
GET /api/v1/database/{db_name}/mappings/

// ì‘ë‹µ
{
  "database": "product_ontology",
  "total": {
    "classes": 25,
    "properties": 150,
    "relationships": 45
  },
  "by_language": {
    "ko": {"classes": 25, "properties": 150, "relationships": 45},
    "en": {"classes": 25, "properties": 150, "relationships": 45},
    "ja": {"classes": 12, "properties": 80, "relationships": 20}
  }
}
```

---

## âš”ï¸ ë³‘í•© ì¶©ëŒ í•´ê²°

### Foundry ìŠ¤íƒ€ì¼ ì¶©ëŒ í•´ê²°

#### 1. ë³‘í•© ì‹œë®¬ë ˆì´ì…˜
```typescript
// ì¶©ëŒ ê°ì§€ë¥¼ ìœ„í•œ ë³‘í•© ì‹œë®¬ë ˆì´ì…˜
POST /api/v1/database/{db_name}/merge/simulate
{
  "source_branch": "feature/new-ontology",
  "target_branch": "main",
  "strategy": "merge"
}

// ì‘ë‹µ
{
  "status": "success",
  "message": "ë³‘í•© ì‹œë®¬ë ˆì´ì…˜ ì™„ë£Œ: 3ê°œ ì¶©ëŒ ê°ì§€",
  "data": {
    "merge_preview": {
      "source_branch": "feature/new-ontology",
      "target_branch": "main",
      "conflicts": [
        {
          "path": "Product.name",
          "type": "content_conflict",
          "source_change": {
            "type": "modified",
            "new_value": "ì œí’ˆëª… v2",
            "old_value": "ì œí’ˆëª…"
          },
          "target_change": {
            "type": "modified",
            "new_value": "ì œí’ˆ ì œëª©",
            "old_value": "ì œí’ˆëª…"
          }
        }
      ],
      "statistics": {
        "changes_to_apply": 15,
        "conflicts_detected": 3,
        "mergeable": false,
        "requires_manual_resolution": true
      }
    }
  }
}
```

#### 2. ì¶©ëŒ í•´ê²°
```typescript
// ìˆ˜ë™ ì¶©ëŒ í•´ê²°
POST /api/v1/database/{db_name}/merge/resolve
{
  "source_branch": "feature/new-ontology",
  "target_branch": "main",
  "strategy": "merge",
  "message": "ì¶©ëŒ í•´ê²°: ì œí’ˆëª… ì—…ë°ì´íŠ¸",
  "author": "admin@company.com",
  "resolutions": [
    {
      "path": "Product.name",
      "resolution_type": "use_value",
      "resolved_value": "ì œí’ˆ ì œëª© v2",
      "metadata": {
        "reason": "ë‘ ë³€ê²½ì‚¬í•­ ê²°í•©"
      }
    }
  ]
}
```

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬

### ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…

#### 1. ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
```typescript
POST /api/v1/database/create
{
  "name": "product_ontology",
  "description": "ì œí’ˆ ì¹´íƒˆë¡œê·¸ ì˜¨í†¨ë¡œì§€"
}
```

#### 2. ë°ì´í„°ë² ì´ìŠ¤ ëª©ë¡ ì¡°íšŒ
```typescript
GET /api/v1/database/list

// ì‘ë‹µ
{
  "databases": [
    {
      "name": "product_ontology",
      "description": "ì œí’ˆ ì¹´íƒˆë¡œê·¸ ì˜¨í†¨ë¡œì§€",
      "created_at": "2024-01-01T00:00:00Z",
      "size": "15.2MB",
      "status": "active"
    }
  ]
}
```

#### 3. ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœ
```typescript
GET /api/v1/database/exists/{db_name}

// ì‘ë‹µ
{
  "exists": true,
  "name": "product_ontology",
  "status": "active",
  "branches": ["main", "develop"],
  "current_branch": "main"
}
```

---

## ğŸ” ì¿¼ë¦¬ ì‹œìŠ¤í…œ

### êµ¬ì¡°í™”ëœ ì¿¼ë¦¬ ì¸í„°í˜ì´ìŠ¤

#### 1. ê¸°ë³¸ ì¿¼ë¦¬
```typescript
POST /api/v1/query/{db_name}/execute
{
  "type": "select",
  "class_id": "Product",
  "filters": [
    {
      "property": "category",
      "operator": "eq",
      "value": "electronics"
    }
  ],
  "limit": 10,
  "offset": 0
}
```

#### 2. ê´€ê³„ë¥¼ í¬í•¨í•œ ë³µí•© ì¿¼ë¦¬
```typescript
POST /api/v1/query/{db_name}/execute
{
  "type": "select",
  "class_id": "Product",
  "filters": [
    {
      "property": "price",
      "operator": "gte",
      "value": {
        "amount": 100000,
        "currency": "KRW"
      }
    }
  ],
  "relationships": [
    {
      "predicate": "hasCategory",
      "target_class": "Category",
      "direction": "outgoing"
    }
  ],
  "include_labels": true,
  "language": "ko"
}
```

#### 3. ì§‘ê³„ ì¿¼ë¦¬
```typescript
POST /api/v1/query/{db_name}/execute
{
  "type": "count",
  "class_id": "Product",
  "filters": [
    {
      "property": "status",
      "operator": "eq",
      "value": "active"
    }
  ],
  "group_by": ["category"]
}
```

---

## ğŸ”„ ê´€ê³„ ê´€ë¦¬

### ê³ ê¸‰ ê´€ê³„ ê¸°ëŠ¥

#### 1. ìˆœí™˜ ì°¸ì¡° íƒì§€
```typescript
// ì˜¨í†¨ë¡œì§€ ìƒì„± ì¤‘ ìë™ íƒì§€
POST /api/v1/ontology/{db_name}/create
{
  "id": "Category",
  "relationships": [
    {
      "predicate": "hasParent",
      "target_class": "Category",
      "cardinality": "many_to_one"
    }
  ]
}

// ì‹œìŠ¤í…œì´ ìˆœí™˜ ì°¸ì¡°ë¥¼ ìë™ìœ¼ë¡œ íƒì§€í•˜ê³  ë°©ì§€
```

#### 2. ê´€ê³„ ê²½ë¡œ ì¶”ì 
```typescript
// ì—”í‹°í‹° ê°„ ê²½ë¡œ ì°¾ê¸°
GET /api/v1/ontology/{db_name}/path?from=Product&to=Brand

// ì‘ë‹µ
{
  "paths": [
    {
      "length": 2,
      "relationships": [
        {"predicate": "hasCategory", "target": "Category"},
        {"predicate": "hasBrand", "target": "Brand"}
      ]
    }
  ]
}
```

#### 3. ê´€ê³„ ê²€ì¦
```typescript
// ì‹¬ê°ë„ ìˆ˜ì¤€ì´ í¬í•¨ëœ ê²€ì¦ ê²°ê³¼
{
  "validation_results": [
    {
      "severity": "error",
      "message": "ìˆœí™˜ ì°¸ì¡° ê°ì§€",
      "path": "Product -> Category -> Product"
    },
    {
      "severity": "warning",
      "message": "ê¹Šì€ ê´€ê³„ ì¤‘ì²© (5ë ˆë²¨ ì´ˆê³¼)",
      "path": "Product -> Category -> SubCategory -> ..."
    }
  ]
}
```

---

## ğŸŒ ì›¹ì†Œì¼“ ë° ì‹¤ì‹œê°„ ê¸°ëŠ¥

### ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
```typescript
// ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ WebSocket ì—°ê²°
const ws = new WebSocket('ws://localhost:8000/ws/updates/{db_name}');

// ë©”ì‹œì§€ íƒ€ì…
interface UpdateMessage {
  type: 'ontology_created' | 'ontology_updated' | 'ontology_deleted' | 'merge_completed';
  data: {
    entity_id: string;
    database: string;
    timestamp: string;
    changes: any;
  };
}

// íŠ¹ì • ì´ë²¤íŠ¸ êµ¬ë…
ws.send(JSON.stringify({
  action: 'subscribe',
  events: ['ontology_created', 'merge_completed']
}));
```

---

## ğŸ“Š ì—ëŸ¬ ì²˜ë¦¬

### í‘œì¤€í™”ëœ ì—ëŸ¬ ì‘ë‹µ

#### 1. ê²€ì¦ ì˜¤ë¥˜
```typescript
// HTTP 400 - ì˜ëª»ëœ ìš”ì²­
{
  "status": "error",
  "message": "ê²€ì¦ ì‹¤íŒ¨",
  "detail": "ì´ë©”ì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤",
  "code": "VALIDATION_ERROR",
  "field": "email"
}
```

#### 2. ë³´ì•ˆ ìœ„ë°˜
```typescript
// HTTP 400 - ì˜ëª»ëœ ìš”ì²­
{
  "status": "error",
  "message": "ë³´ì•ˆ ìœ„ë°˜ ê°ì§€",
  "detail": "SQL ì¸ì ì…˜ íŒ¨í„´ ê°ì§€",
  "code": "SECURITY_VIOLATION"
}
```

#### 3. ì¶©ëŒ ì˜¤ë¥˜
```typescript
// HTTP 409 - ì¶©ëŒ
{
  "status": "error",
  "message": "ë³‘í•© ì¶©ëŒ ê°ì§€",
  "detail": "ìˆ˜ë™ í•´ê²° í•„ìš”",
  "code": "MERGE_CONFLICT",
  "conflicts": [...]
}
```

#### 4. ì°¾ì„ ìˆ˜ ì—†ìŒ ì˜¤ë¥˜
```typescript
// HTTP 404 - ì°¾ì„ ìˆ˜ ì—†ìŒ
{
  "status": "error",
  "message": "ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ",
  "detail": "ë°ì´í„°ë² ì´ìŠ¤ 'test_db'ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤",
  "code": "NOT_FOUND"
}
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë° ê°œë°œ

### ê°œë°œ í™˜ê²½ ì„¤ì •

#### 1. ì„œë¹„ìŠ¤ ì‹œì‘
```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ ì‹œì‘
cd /Users/isihyeon/Desktop/SPICE\ HARVESTER/backend
./start_services.sh

# ì„œë¹„ìŠ¤ ì ‘ì† ì£¼ì†Œ:
# - BFF: http://localhost:8002
# - OMS: http://localhost:8000
# - TerminusDB: http://localhost:6363
```

#### 2. í—¬ìŠ¤ ì²´í¬
```typescript
// ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
GET http://localhost:8002/health  // BFF
GET http://localhost:8000/health  // OMS

// ì˜ˆìƒ ì‘ë‹µ
{
  "status": "healthy",
  "timestamp": "2024-01-01T00:00:00Z",
  "services": {
    "database": "connected",
    "terminus": "connected"
  }
}
```

#### 3. ë³µí•© íƒ€ì… í…ŒìŠ¤íŠ¸
```typescript
// ë³µí•© íƒ€ì… ê²€ì¦ í…ŒìŠ¤íŠ¸
POST http://localhost:8002/api/v1/ontology/test_db/create
{
  "id": "TestClass",
  "properties": {
    "email": {
      "type": "custom:email",
      "constraints": {
        "domains": ["test.com"]
      }
    }
  }
}
```

---

## ğŸš€ í”„ë¡œë•ì…˜ ë°°í¬

### í”„ë¡œë•ì…˜ ê³ ë ¤ì‚¬í•­

#### 1. í™˜ê²½ ë³€ìˆ˜
```bash
# í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜
TERMINUS_DB_URL=http://terminusdb:6363
TERMINUS_DB_USER=admin
TERMINUS_DB_PASSWORD=password
BFF_PORT=8002
OMS_PORT=8000
DATABASE_PATH=/data/label_mappings.db
LOG_LEVEL=INFO
```

#### 2. ë³´ì•ˆ ì„¤ì •
```typescript
// í”„ë¡œë•ì…˜ ë³´ì•ˆ ì„¤ì •
{
  "ALLOWED_ORIGINS": ["https://yourapp.com"],
  "RATE_LIMIT_ENABLED": true,
  "CORS_CREDENTIALS": true,
  "HTTPS_ONLY": true,
  "CSRF_PROTECTION": true
}
```

#### 3. ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…
```typescript
// êµ¬ì¡°í™”ëœ ë¡œê¹… í˜•ì‹
{
  "timestamp": "2024-01-01T00:00:00Z",
  "level": "INFO",
  "service": "BFF",
  "message": "ì˜¨í†¨ë¡œì§€ ìƒì„±ë¨",
  "context": {
    "database": "product_ontology",
    "class_id": "Product",
    "user": "admin"
  }
}
```

---

## ğŸ“± í”„ë¡ íŠ¸ì—”ë“œ í†µí•© ì˜ˆì‹œ

### React í†µí•©

#### 1. API í´ë¼ì´ì–¸íŠ¸ ì„¤ì •
```typescript
// api/client.ts
class SpiceHarvesterClient {
  private bffUrl = 'http://localhost:8002';
  private omsUrl = 'http://localhost:8000';
  
  async createOntology(dbName: string, ontologyData: any) {
    const response = await fetch(`${this.bffUrl}/api/v1/ontology/${dbName}/create`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(ontologyData),
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    
    return response.json();
  }
  
  async queryOntologies(dbName: string, queryData: any) {
    const response = await fetch(`${this.bffUrl}/api/v1/query/${dbName}/execute`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(queryData),
    });
    
    return response.json();
  }
}
```

#### 2. ë³µí•© íƒ€ì… í¼ ì»´í¬ë„ŒíŠ¸
```typescript
// components/ComplexTypeForm.tsx
import React, { useState } from 'react';

interface ComplexTypeFormProps {
  onSubmit: (data: any) => void;
}

const ComplexTypeForm: React.FC<ComplexTypeFormProps> = ({ onSubmit }) => {
  const [formData, setFormData] = useState({
    id: '',
    properties: {}
  });
  
  const handleAddProperty = (name: string, type: string, constraints: any) => {
    setFormData(prev => ({
      ...prev,
      properties: {
        ...prev.properties,
        [name]: {
          type,
          constraints
        }
      }
    }));
  };
  
  return (
    <form onSubmit={(e) => { e.preventDefault(); onSubmit(formData); }}>
      {/* ì´ë©”ì¼ ì†ì„± */}
      <div>
        <label>ì´ë©”ì¼ ì†ì„±:</label>
        <input 
          type="text" 
          placeholder="ì†ì„± ì´ë¦„"
          onChange={(e) => handleAddProperty(e.target.value, 'custom:email', {
            domains: ['company.com'],
            maxLength: 255
          })}
        />
      </div>
      
      {/* í†µí™” ì†ì„± */}
      <div>
        <label>í†µí™” ì†ì„±:</label>
        <input 
          type="text" 
          placeholder="ì†ì„± ì´ë¦„"
          onChange={(e) => handleAddProperty(e.target.value, 'custom:money', {
            currency: 'KRW',
            precision: 2,
            minimum: 0
          })}
        />
      </div>
      
      <button type="submit">ì˜¨í†¨ë¡œì§€ ìƒì„±</button>
    </form>
  );
};
```

#### 3. ë²„ì „ ì œì–´ ì»´í¬ë„ŒíŠ¸
```typescript
// components/VersionControl.tsx
import React, { useState, useEffect } from 'react';

const VersionControl: React.FC<{ dbName: string }> = ({ dbName }) => {
  const [branches, setBranches] = useState([]);
  const [currentBranch, setCurrentBranch] = useState('');
  
  useEffect(() => {
    fetchBranches();
  }, [dbName]);
  
  const fetchBranches = async () => {
    const response = await fetch(`http://localhost:8000/api/v1/branch/${dbName}/list`);
    const data = await response.json();
    setBranches(data.branches);
    setCurrentBranch(data.current);
  };
  
  const createBranch = async (branchName: string) => {
    await fetch(`http://localhost:8000/api/v1/branch/${dbName}/create`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        branch_name: branchName,
        from_branch: currentBranch
      })
    });
    fetchBranches();
  };
  
  const checkout = async (branchName: string) => {
    await fetch(`http://localhost:8000/api/v1/branch/${dbName}/checkout`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        target: branchName,
        target_type: 'branch'
      })
    });
    fetchBranches();
  };
  
  return (
    <div>
      <h3>ë²„ì „ ì œì–´</h3>
      <p>í˜„ì¬ ë¸Œëœì¹˜: <strong>{currentBranch}</strong></p>
      
      <div>
        <h4>ë¸Œëœì¹˜ ëª©ë¡:</h4>
        <ul>
          {branches.map((branch: any) => (
            <li key={branch.name}>
              {branch.name} 
              {branch.current && <span> (í˜„ì¬)</span>}
              {!branch.current && (
                <button onClick={() => checkout(branch.name)}>
                  ì²´í¬ì•„ì›ƒ
                </button>
              )}
            </li>
          ))}
        </ul>
      </div>
      
      <div>
        <input 
          type="text" 
          placeholder="ìƒˆ ë¸Œëœì¹˜ ì´ë¦„"
          onKeyPress={(e) => {
            if (e.key === 'Enter') {
              createBranch(e.target.value);
              e.target.value = '';
            }
          }}
        />
      </div>
    </div>
  );
};
```

---

## ğŸ¯ ëª¨ë²” ì‚¬ë¡€ ë° ê¶Œì¥ì‚¬í•­

### 1. ë°ì´í„° ê²€ì¦
- í”„ë¡ íŠ¸ì—”ë“œì—ì„œ í•­ìƒ ë³µí•© íƒ€ì… ì œì•½ì¡°ê±´ì„ ê²€ì¦í•˜ì„¸ìš”
- Pydantic ëª¨ë¸ê³¼ ì¼ì¹˜í•˜ëŠ” TypeScript ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”
- ë” ë‚˜ì€ UXë¥¼ ìœ„í•´ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ê²€ì¦ì„ êµ¬í˜„í•˜ì„¸ìš”

### 2. ì—ëŸ¬ ì²˜ë¦¬
- ë„¤íŠ¸ì›Œí¬ ì‹¤íŒ¨ì— ëŒ€í•œ ì¬ì‹œë„ ë¡œì§ì„ êµ¬í˜„í•˜ì„¸ìš”
- ì‚¬ìš©ì ì¹œí™”ì ì¸ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ì„¸ìš”
- ë””ë²„ê¹…ì„ ìœ„í•´ ì—ëŸ¬ë¥¼ ë¡œê¹…í•˜ì„¸ìš”

### 3. ì„±ëŠ¥ ìµœì í™”
- ëŒ€ìš©ëŸ‰ ë°ì´í„°ì…‹ì—ëŠ” í˜ì´ì§€ë„¤ì´ì…˜ì„ ì‚¬ìš©í•˜ì„¸ìš”
- ìì£¼ ì ‘ê·¼í•˜ëŠ” ë°ì´í„°ì— ëŒ€í•œ ìºì‹±ì„ êµ¬í˜„í•˜ì„¸ìš”
- ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ì—ëŠ” WebSocket ì‚¬ìš©ì„ ê³ ë ¤í•˜ì„¸ìš”

### 4. ë³´ì•ˆ
- ëª¨ë“  ì‚¬ìš©ì ì…ë ¥ì„ ì •í™”í•˜ì„¸ìš”
- íŒŒì¼ ì—…ë¡œë“œ(í¬ê¸°, íƒ€ì…, ë‚´ìš©)ë¥¼ ê²€ì¦í•˜ì„¸ìš”
- í”„ë¡œë•ì…˜ì—ì„œëŠ” HTTPSë¥¼ ì‚¬ìš©í•˜ì„¸ìš”

### 5. êµ­ì œí™”
- ë ˆì´ë¸” ë§¤í•‘ ì‹œìŠ¤í…œì„ í™œìš©í•˜ì„¸ìš”
- ë‹¤êµ­ì–´ë¥¼ ì§€ì›í•˜ì„¸ìš”
- ë¡œì¼€ì¼ë³„ í˜•ì‹ì„ ì‚¬ìš©í•˜ì„¸ìš”

---

ì´ í¬ê´„ì ì¸ ê°€ì´ë“œëŠ” SPICE HARVESTER ë°±ì—”ë“œì—ì„œ êµ¬í˜„ëœ ëª¨ë“  ê¸°ëŠ¥ì„ ë‹¤ë£¹ë‹ˆë‹¤. ë³µí•© íƒ€ì… ì‹œìŠ¤í…œ, ë²„ì „ ì œì–´, ë³´ì•ˆ ê¸°ëŠ¥ ë° ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  ì„œë¹„ìŠ¤ì™€ í†µí•©í•˜ì—¬ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì„ ìœ„í•œ ì™„ì „í•œ ì°¸ì¡° ìë£Œë¡œ í™œìš©í•˜ì„¸ìš”.

ì¶”ê°€ ì§ˆë¬¸ì´ë‚˜ ê¸°ëŠ¥ì´ í•„ìš”í•˜ì‹œë©´ íŠ¹ì • ì—”ë“œí¬ì¸íŠ¸ ë¬¸ì„œë¥¼ ì°¸ì¡°í•˜ê±°ë‚˜ ê°œë°œíŒ€ì— ë¬¸ì˜í•˜ì„¸ìš”.

**ğŸ”¥ Think Ultra! ì´ ê°€ì´ë“œëŠ” SPICE HARVESTER ë°±ì—”ë“œì˜ ì™„ì „í•œ êµ¬í˜„ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤ - ëª¨ë“  ê¸°ëŠ¥, ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸, ëª¨ë“  ê¸°ëŠ¥ì´ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ìš”êµ¬ì‚¬í•­ì— ë§ê²Œ ë¬¸ì„œí™”ë˜ì—ˆìŠµë‹ˆë‹¤.**